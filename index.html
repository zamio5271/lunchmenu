<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>점심메뉴 룰렛</title>
  <style>
    :root{--wheel-max:400px;--black:#111;--accent:#ff7043;}
    *{box-sizing:border-box;margin:0;padding:0;}
    body{font-family:Helvetica,Arial,sans-serif;display:flex;flex-direction:column;align-items:center;gap:clamp(16px,4vw,32px);background:#f5f5f5;min-height:100vh;padding:clamp(16px,4vw,32px);overflow-x:hidden;}
    h1{font-size:clamp(24px,6vw,32px);}
    .input-bar{width:100%;max-width:var(--wheel-max);display:flex;gap:8px;}
    .input-bar input{flex:1;padding:12px 14px;font-size:16px;border:1px solid #ccc;border-radius:8px;}
    .input-bar button{padding:12px 20px;font-size:16px;border:none;border-radius:8px;background:var(--black);color:#fff;cursor:pointer;}
    #wheel-container{position:relative;width:100%;max-width:var(--wheel-max);}#wheel{width:100%;height:auto;display:block;cursor:pointer;touch-action:none;}
    #pointer{position:absolute;top:-1.5vw;left:50%;transform:translateX(-50%);width:0;height:0;border-left:1.5vw solid transparent;border-right:1.5vw solid transparent;border-top:2.5vw solid var(--black);pointer-events:none;}
    #spin-btn{margin-top:clamp(16px,4vw,28px);padding:14px 32px;font-size:18px;font-weight:bold;border:2px solid var(--black);border-radius:10px;background:#fff;cursor:pointer;width:100%;max-width:var(--wheel-max);}  
    /* 🎉 팝업 */
    #popup{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.55);z-index:999;}
    #popup .box{background:#fff;border-radius:12px;padding:32px 24px;text-align:center;max-width:80%;box-shadow:0 8px 20px rgba(0,0,0,.4);}
    #popup h2{font-size:clamp(22px,6vw,28px);margin-bottom:16px;line-height:1.3;}
    #close-btn{margin-top:20px;padding:10px 24px;font-size:16px;border:none;border-radius:8px;background:var(--accent);color:#fff;cursor:pointer;}
  </style>
</head>
<body>
  <h1>점심메뉴 룰렛</h1>
  <div class="input-bar"><input id="menu-input" type="text" placeholder="메뉴 이름 입력" /><button id="add-btn">추가</button></div>
  <div id="wheel-container"><div id="pointer"></div><canvas id="wheel"></canvas></div>
  <button id="spin-btn">룰렛 돌리기</button>
  <div id="popup"><div class="box"><h2 id="popup-text">🍽️</h2><button id="close-btn">닫기</button></div></div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <script>
    // ---------- LocalStorage ----------
    const defaultMenus=['치킨','김치찌개','김치','햄버거','라면','김밥','샐러드','피자','초밥','떡볶이'];
    let menus=JSON.parse(localStorage.getItem('menus'))||[...defaultMenus];
    const baseColors=['#5d3fa9','#c2185b','#e64a19','#d32f2f','#ff7043','#ffa726','#ffd54f','#8bc34a','#26a69a','#3949ab'];
    // ---------- DOM ----------
    const canvas=document.getElementById('wheel');const ctx=canvas.getContext('2d');
    const spinBtn=document.getElementById('spin-btn');const addBtn=document.getElementById('add-btn');const input=document.getElementById('menu-input');
    const popup=document.getElementById('popup');const popupTxt=document.getElementById('popup-text');const closeBtn=document.getElementById('close-btn');
    let rotation=0;
    const randColor=()=>`hsl(${Math.floor(Math.random()*360)},70%,60%)`;

    function resizeCanvas(){const size=document.getElementById('wheel-container').clientWidth;canvas.width=size;canvas.height=size;drawWheel();}

    function drawWheel(){ctx.clearRect(0,0,canvas.width,canvas.height);if(!menus.length) return;const sliceAngle=2*Math.PI/menus.length;const cx=canvas.width/2,cy=canvas.height/2,r=canvas.width/2-10;for(let i=0;i<menus.length;i++){const start=rotation+i*sliceAngle,end=start+sliceAngle;ctx.beginPath();ctx.moveTo(cx,cy);ctx.arc(cx,cy,r,start,end);ctx.fillStyle=baseColors[i%baseColors.length]||randColor();ctx.fill();ctx.strokeStyle='#fff';ctx.lineWidth=2;ctx.stroke();const mid=start+sliceAngle/2;const tx=cx+Math.cos(mid)*r*0.6,ty=cy+Math.sin(mid)*r*0.6;ctx.save();ctx.translate(tx,ty);ctx.rotate(mid+Math.PI/2);ctx.fillStyle='#fff';ctx.font=`${Math.max(12,r*0.07)}px sans-serif`;ctx.textAlign='center';ctx.fillText(menus[i],0,0);ctx.restore();}ctx.beginPath();ctx.arc(cx,cy,4,0,2*Math.PI);ctx.fillStyle='#000';ctx.fill();}

    function burstConfetti(){const duration=1600,end=Date.now()+duration;const defaults={startVelocity:30,spread:360,ticks:60,zIndex:1000};function random(min,max){return Math.random()*(max-min)+min;}const interval=setInterval(()=>{const timeLeft=end-Date.now();if(timeLeft<=0){return clearInterval(interval);}const particleCount=50*(timeLeft/duration);confetti(Object.assign({},defaults,{particleCount,origin:{x:random(0.1,0.3),y:Math.random()*0.2}}));confetti(Object.assign({},defaults,{particleCount,origin:{x:random(0.7,0.9),y:Math.random()*0.2}}));},250);}    

    function spin(){if(!menus.length) return alert('메뉴가 없습니다!');spinBtn.disabled=true;const sliceAngle=2*Math.PI/menus.length;const extra=Math.random()*sliceAngle;const target=rotation+5*2*Math.PI+extra;gsap.to({rot:rotation},{rot:target,duration:5,ease:'power4.out',onUpdate(){rotation=this.targets()[0].rot;drawWheel();},onComplete(){rotation%=2*Math.PI;const pointerAngle=(3*Math.PI/2-rotation+2*Math.PI)%(2*Math.PI);const idx=Math.floor(pointerAngle/sliceAngle)%menus.length;const winner=menus[idx];popupTxt.innerHTML=`🎉 오늘의 점심은 <br><b>${winner}</b> 🎊`;popup.style.display='flex';burstConfetti();spinBtn.disabled=false;}});}    

    function addMenu(){const v=input.value.trim();if(!v) return;menus.push(v);localStorage.setItem('menus',JSON.stringify(menus));input.value='';drawWheel();}

    function handleCanvasClick(e){if(!menus.length) return;const rect=canvas.getBoundingClientRect();const scale=canvas.width/rect.width;const x=(e.clientX-rect.left)*scale,y=(e.clientY-rect.top)*scale;const cx=canvas.width/2,cy=canvas.height/2,constR=canvas.width/2-10;if(Math.hypot(x-cx,y-cy)>constR) return;const sliceAngle=2*Math.PI/menus.length;const clickAngle=(Math.atan2(y-cy,x-cx)-rotation+2*Math.PI)%(2*Math.PI);const idx=Math.floor(clickAngle/sliceAngle);menus.splice(idx,1);localStorage.setItem('menus',JSON.stringify(menus));drawWheel();}

    // 초기화 및 이벤트
    resizeCanvas();window.addEventListener('resize',resizeCanvas);spinBtn.addEventListener('click',spin);addBtn.addEventListener('click',addMenu);input.addEventListener('keydown',e=>{if(e.key==='Enter')addMenu();});canvas.addEventListener('click',handleCanvasClick);closeBtn.addEventListener('click',()=>popup.style.display='none');
  </script>
</body>
</html>
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>점심메뉴 룰렛</title>
  <style>
    :root{--wheel-max:400px;--black:#111;--accent:#ff7043;}
    *{box-sizing:border-box;margin:0;padding:0;}
    body{font-family:Helvetica,Arial,sans-serif;display:flex;flex-direction:column;align-items:center;gap:clamp(16px,4vw,32px);background:#f5f5f5;min-height:100vh;padding:clamp(16px,4vw,32px);overflow-x:hidden;}
    h1{font-size:clamp(24px,6vw,32px);}
    .input-bar{width:100%;max-width:var(--wheel-max);display:flex;gap:8px;}
    .input-bar input{flex:1;padding:12px 14px;font-size:16px;border:1px solid #ccc;border-radius:8px;}
    .input-bar button{padding:12px 20px;font-size:16px;border:none;border-radius:8px;background:var(--black);color:#fff;cursor:pointer;}
    #wheel-container{position:relative;width:100%;max-width:var(--wheel-max);}#wheel{width:100%;height:auto;display:block;cursor:pointer;touch-action:none;}
    #pointer{position:absolute;top:-1.5vw;left:50%;transform:translateX(-50%);width:0;height:0;border-left:1.5vw solid transparent;border-right:1.5vw solid transparent;border-top:2.5vw solid var(--black);pointer-events:none;}
    #spin-btn{margin-top:clamp(16px,4vw,28px);padding:14px 32px;font-size:18px;font-weight:bold;border:2px solid var(--black);border-radius:10px;background:#fff;cursor:pointer;width:100%;max-width:var(--wheel-max);}  
    /* 🎉 팝업 */
    #popup{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.55);z-index:999;}
    #popup .box{background:#fff;border-radius:12px;padding:32px 24px;text-align:center;max-width:80%;box-shadow:0 8px 20px rgba(0,0,0,.4);}
    #popup h2{font-size:clamp(22px,6vw,28px);margin-bottom:16px;line-height:1.3;}
    #close-btn{margin-top:20px;padding:10px 24px;font-size:16px;border:none;border-radius:8px;background:var(--accent);color:#fff;cursor:pointer;}
  </style>
</head>
<body>
  <h1>점심메뉴 룰렛</h1>
  <div class="input-bar"><input id="menu-input" type="text" placeholder="메뉴 이름 입력" /><button id="add-btn">추가</button></div>
  <div id="wheel-container"><div id="pointer"></div><canvas id="wheel"></canvas></div>
  <button id="spin-btn">룰렛 돌리기</button>
  <div id="popup"><div class="box"><h2 id="popup-text">🍽️</h2><button id="close-btn">닫기</button></div></div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <script>
    // ---------- LocalStorage ----------
    const defaultMenus=['치킨','김치찌개','김치','햄버거','라면','김밥','샐러드','피자','초밥','떡볶이'];
    let menus=JSON.parse(localStorage.getItem('menus'))||[...defaultMenus];
    const baseColors=['#5d3fa9','#c2185b','#e64a19','#d32f2f','#ff7043','#ffa726','#ffd54f','#8bc34a','#26a69a','#3949ab'];
    // ---------- DOM ----------
    const canvas=document.getElementById('wheel');const ctx=canvas.getContext('2d');
    const spinBtn=document.getElementById('spin-btn');const addBtn=document.getElementById('add-btn');const input=document.getElementById('menu-input');
    const popup=document.getElementById('popup');const popupTxt=document.getElementById('popup-text');const closeBtn=document.getElementById('close-btn');
    let rotation=0;
    const randColor=()=>`hsl(${Math.floor(Math.random()*360)},70%,60%)`;

    function resizeCanvas(){const size=document.getElementById('wheel-container').clientWidth;canvas.width=size;canvas.height=size;drawWheel();}

    function drawWheel(){ctx.clearRect(0,0,canvas.width,canvas.height);if(!menus.length) return;const sliceAngle=2*Math.PI/menus.length;const cx=canvas.width/2,cy=canvas.height/2,r=canvas.width/2-10;for(let i=0;i<menus.length;i++){const start=rotation+i*sliceAngle,end=start+sliceAngle;ctx.beginPath();ctx.moveTo(cx,cy);ctx.arc(cx,cy,r,start,end);ctx.fillStyle=baseColors[i%baseColors.length]||randColor();ctx.fill();ctx.strokeStyle='#fff';ctx.lineWidth=2;ctx.stroke();const mid=start+sliceAngle/2;const tx=cx+Math.cos(mid)*r*0.6,ty=cy+Math.sin(mid)*r*0.6;ctx.save();ctx.translate(tx,ty);ctx.rotate(mid+Math.PI/2);ctx.fillStyle='#fff';ctx.font=`${Math.max(12,r*0.07)}px sans-serif`;ctx.textAlign='center';ctx.fillText(menus[i],0,0);ctx.restore();}ctx.beginPath();ctx.arc(cx,cy,4,0,2*Math.PI);ctx.fillStyle='#000';ctx.fill();}

    function burstConfetti(){const duration=1600,end=Date.now()+duration;const defaults={startVelocity:30,spread:360,ticks:60,zIndex:1000};function random(min,max){return Math.random()*(max-min)+min;}const interval=setInterval(()=>{const timeLeft=end-Date.now();if(timeLeft<=0){return clearInterval(interval);}const particleCount=50*(timeLeft/duration);confetti(Object.assign({},defaults,{particleCount,origin:{x:random(0.1,0.3),y:Math.random()*0.2}}));confetti(Object.assign({},defaults,{particleCount,origin:{x:random(0.7,0.9),y:Math.random()*0.2}}));},250);}    

    function spin(){if(!menus.length) return alert('메뉴가 없습니다!');spinBtn.disabled=true;const sliceAngle=2*Math.PI/menus.length;const extra=Math.random()*sliceAngle;const target=rotation+5*2*Math.PI+extra;gsap.to({rot:rotation},{rot:target,duration:5,ease:'power4.out',onUpdate(){rotation=this.targets()[0].rot;drawWheel();},onComplete(){rotation%=2*Math.PI;const pointerAngle=(3*Math.PI/2-rotation+2*Math.PI)%(2*Math.PI);const idx=Math.floor(pointerAngle/sliceAngle)%menus.length;const winner=menus[idx];popupTxt.innerHTML=`🎉 오늘의 점심은 <br><b>${winner}</b> 🎊`;popup.style.display='flex';burstConfetti();spinBtn.disabled=false;}});}    

    function addMenu(){const v=input.value.trim();if(!v) return;menus.push(v);localStorage.setItem('menus',JSON.stringify(menus));input.value='';drawWheel();}

    function handleCanvasClick(e){if(!menus.length) return;const rect=canvas.getBoundingClientRect();const scale=canvas.width/rect.width;const x=(e.clientX-rect.left)*scale,y=(e.clientY-rect.top)*scale;const cx=canvas.width/2,cy=canvas.height/2,constR=canvas.width/2-10;if(Math.hypot(x-cx,y-cy)>constR) return;const sliceAngle=2*Math.PI/menus.length;const clickAngle=(Math.atan2(y-cy,x-cx)-rotation+2*Math.PI)%(2*Math.PI);const idx=Math.floor(clickAngle/sliceAngle);menus.splice(idx,1);localStorage.setItem('menus',JSON.stringify(menus));drawWheel();}

    // 초기화 및 이벤트
    resizeCanvas();window.addEventListener('resize',resizeCanvas);spinBtn.addEventListener('click',spin);addBtn.addEventListener('click',addMenu);input.addEventListener('keydown',e=>{if(e.key==='Enter')addMenu();});canvas.addEventListener('click',handleCanvasClick);closeBtn.addEventListener('click',()=>popup.style.display='none');
  </script>
</body>
</html>
